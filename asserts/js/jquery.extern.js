define(["jquery"],function(b){Array.prototype.unique=function(){for(var a={},e=this.length,b=0;b<e;b++)"undefined"==typeof a[this[b]]&&(a[this[b]]=1);this.length=0;for(b in a)this[this.length]=b;return this};b.extend({includeCSSFiles:[],includeCSS:function(a,e){var d="string"==typeof a?[a]:a;e=e?e:TPX.PATH_ASSERTS+"/";for(var c=0;c<d.length;c++){for(var f=d[c].replace(/^\s|\s$/g,""),g=document.createElement("link"),f=e+f+TPX.SUFFIX_CSS,h=!0,k=0;k<b.includeCSSFiles.length;k++)f==b.includeCSSFiles[k]&&
(h=!1);h&&(0<b("link[href='"+f+"']").length||0<b("link[href='"+f+"']").length)&&(h=!1);h&&(b.includeCSSFiles.push(f),g.setAttribute("rel","stylesheet"),g.setAttribute("type","text/css"),g.setAttribute("href",f),document.getElementsByTagName("head")[0].appendChild(g))}},includeJSFiles:[],includeJS:function(a,e){var d="string"==typeof a?[a]:a;e=e?e:TPX.PATH_ASSERTS;for(var c=0;c<d.length;c++){for(var f=d[c].replace(/^\s|\s$/g,""),f=e+f+TPX.SUFFIX_JS,g="src='"+f+"'",h=!0,k=0;k<b.includeJSFiles.length;k++)g==
b.includeJSFiles[k]&&(h=!1);h&&(0<b("script[src='"+f+"']").length||0<b("script[src='"+f+"']").length)&&(h=!1);h&&(b.includeJSFiles.push(g),b("body").append("<script language='javascript' type='text/javascript' "+g+" onload='alert(1);'>\x3c/script>"))}},getRootWindow:function(){for(var a=window;a.self!=a.parent;)a=a.parent;return a},urlencode:function(a){var b="";a+="";for(var d=0;d<a.length;d++)var c=a.charAt(d),f=a.charCodeAt(d).toString(16),b=" "==c?b+"+":-1!="!\"#$%&'()*+,/:;<=>?[]^`{|}~%".indexOf(c)?
b+("%"+f.toString(16)):b+c;return b},urldecode:function(a){for(var b="",d=0;d<a.length;d++){var c=a.charAt(d);"+"==c?b+=" ":"%"==c?(c=a.substring(d+1,d+3),127<parseInt("0x"+c)?(b+=decodeURI("%"+c.toString()+a.substring(d+3,d+9).toString()),d+=8):(b+=ShengUtils.AsciiToString(parseInt("0x"+c)),d+=2)):b+=c}return b},getUrlAnchor:function(){var b=window.location.href,e=b.indexOf("#");return 0<e?b=b.substring(e+1):""},redirect:function(b){window.location.href=b},defaultFormCallback:function(a,e){a?"number"==
typeof a.status?0==a.status?(a.url?b.dialog({lock:!0,title:": (",max:!1,min:!1,fixed:!0,icon:"error.gif",content:a.info,close:function(){a.url&&("[reload]"==a.url?window.location.reload():"[reload-root]"==a.url?b.getRootWindow().location.reload():b.redirect(a.url))},ok:function(){return!0}}):b.dialog.tips(a.info,2,"error.gif"),b("#auto-click-on-error").length&&b("#auto-click-on-error").click()):1==a.status&&(a.info?a.url?b.dialog({lock:!0,title:": )",max:!1,min:!1,fixed:!0,icon:"success.gif",content:a.info,
close:function(){a.url&&("[reload]"==a.url?window.location.reload():"[reload-root]"==a.url?b.getRootWindow().location.reload():b.redirect(a.url))},ok:function(){return!0}}):b.dialog.tips(a.info,2,"success.gif"):a.url&&("[reload]"==a.url?window.location.reload():"[reload-root]"==a.url?b.getRootWindow().location.reload():b.redirect(a.url))):e?e(a):alert("ERROR: Unrecognized data! \n==\n"+a+"\n=="):alert("ERROR: Response Data Empty!")},urlBuild:function(a,e,d){a=a?a:"index";e=e?e:"index";d=d?d:{};var c=
[];c.push(TPX.PATH_ROOT);c.push("/");TPX.REWRITE||c.push("?s=/");c.push(a);c.push("/");c.push(e);c.push("/");for(var f in d)c.push(b.urlencode(f)),c.push("/"),c.push(b.urlencode(d[f])),c.push("/");return c.join("")}});b(function(){var a=["jquery"];if(0<b("form.tpx-ajaxsubmit").length||b("body").hasClass("tpx-use-dialog"))a.push("lhgdialog.base"),a.push("lhgdialog.lang");require(a,function(){b("form.tpx-ajaxsubmit").unbind("submit");b("form.tpx-ajaxsubmit").on("submit",function(a){a&&a.preventDefault();
if(TPX.UEDITOR)for(a=0;a<TPX.UEDITOR.length;a++)TPX.UEDITOR[a].sync();b(".fuelux .pillbox").each(function(a,c){var d=b(c).attr("id"),e=b("#"+d).pillbox("items"),f=[];for(a=0;a<e.length;a++)f.push(e[a].value);b("input[name="+d+"]").val(f.join(","))});a=b(this).serializeArray();var d=null,d=b(this).attr("callback")?eval(b(this).attr("callback")):b.defaultFormCallback,c=b.dialog.tips(lhgdialog_lang.LOADING,10,"loading.gif"),f=setTimeout(function(){c&&(c.close(),c=null);b.dialog.alert(lhgdialog_lang.TIMEOUT)},
3E4),g=function(a){c&&(c.close(),c=null);clearTimeout(f);d(a)};"post"==b(this).attr("method")?b.post(b(this).attr("action"),a,g):b.get(b(this).attr("action"),a,g);return!1})})})});