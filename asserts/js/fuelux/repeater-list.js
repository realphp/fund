(function(f){"function"===typeof define&&define.amd?define(["jquery","fuelux/repeater"],f):f(jQuery)})(function(f){function p(a,b,e,c,d){var g=c[d].className,l=b[e][c[d].property],h=f("<td></td>"),k=c[d]._auto_width;h.addClass(void 0!==g?g:"").append(l);void 0!==k&&h.outerWidth(k);a.append(h);this.viewOptions.list_columnRendered&&this.viewOptions.list_columnRendered({container:a,columnAttr:c[d].property,item:h,rowData:b[e]},function(){})}function q(a,b,e){var c=f('<div class="repeater-list-heading"><span class="glyphicon rlc"></span></div>'),
d=f("<th></th>"),g=this,l,h,k,n,m;c.data("fu_item_index",e);c.prepend(b[e].label);d.html(c.html()).find("[id]").removeAttr("id");d.append(c);l=d.add(c);n=c.find(".glyphicon.rlc:first");m=n.add(d.find(".glyphicon.rlc:first"));h=b[e].className;void 0!==h&&l.addClass(h);if(k=b[e].sortable)l.addClass("sortable"),c.on("click.fu.repeaterList",function(){g.list_sortProperty="string"===typeof k?k:b[e].property;c.hasClass("sorted")?n.hasClass("glyphicon-chevron-up")?(m.removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down"),
g.list_sortDirection="desc"):g.viewOptions.list_sortClearing?(l.removeClass("sorted"),m.removeClass("glyphicon-chevron-down"),g.list_sortDirection=null,g.list_sortProperty=null):(m.removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up"),g.list_sortDirection="asc"):(a.find("th, .repeater-list-heading").removeClass("sorted"),m.removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up"),g.list_sortDirection="asc",l.addClass("sorted"));g.render({clearInfinite:!0,pageIncrement:null})});
if("asc"===b[e].sortDirection||"desc"===b[e].sortDirection)a.find("th, .repeater-list-heading").removeClass("sorted"),l.addClass("sortable sorted"),"asc"===b[e].sortDirection?(m.addClass("glyphicon-chevron-up"),this.list_sortDirection="asc"):(m.addClass("glyphicon-chevron-down"),this.list_sortDirection="desc"),this.list_sortProperty="string"===typeof k?k:b[e].property;a.append(d)}function r(a,b,e){var c=f("<tr></tr>"),d=this,g,l;this.viewOptions.list_selectable&&(c.addClass("selectable"),c.attr("tabindex",
0),c.data("item_data",b[e]),c.on("click.fu.repeaterList",function(){var a=f(this);a.hasClass("selected")?(a.removeClass("selected"),a.find(".repeater-list-check").remove(),a.$element.trigger("deselected.fu.repeaterList",a)):("multi"!==d.viewOptions.list_selectable&&(d.$canvas.find(".repeater-list-check").remove(),d.$canvas.find(".repeater-list tbody tr.selected").each(function(){f(this).removeClass("selected");d.$element.trigger("deselected.fu.repeaterList",f(this))})),a.addClass("selected"),a.find("td:first").prepend('<div class="repeater-list-check"><span class="glyphicon glyphicon-ok"></span></div>'),
d.$element.trigger("selected.fu.repeaterList",a))}),c.keyup(function(a){13===a.keyCode&&c.trigger("click.fu.repeaterList")}));a.append(c);g=0;for(l=this.list_columns.length;g<l;g++)p.call(this,c,b,e,this.list_columns,g);this.viewOptions.list_rowRendered&&this.viewOptions.list_rowRendered({container:a,item:c,rowData:b[e]},function(){})}function t(a,b){var e=a.find("tbody"),c;1>e.length&&(e=f('<tbody data-container="true"></tbody>'),a.append(e));b.items&&1>b.items.length&&(c=f('<tr class="empty"><td colspan="'+
this.list_columns.length+'"></td></tr>'),c.find("td").append(this.viewOptions.list_noItemsHTML),e.append(c))}function u(a,b){function e(a,b){if(!b)return!1;if(!a||b.length!==a.length)return!0;d=0;for(l=b.length;d<l;d++){if(!a[d])return!0;for(g in b[d])if(a[d][g]!==b[d][g])return!0}return!1}var c=b.columns||[],d,g,l,h,k;if(this.list_firstRender||e(this.list_columns,c)){a.find("thead").remove();this.list_columns=c;this.list_firstRender=!1;this.$loader.removeClass("noHeader");h=f('<thead data-preserve="deep"><tr></tr></thead>');
k=h.find("tr");d=0;for(l=c.length;d<l;d++)q.call(this,k,c,d);a.prepend(h);v.call(this,k)}}function v(a){var b=[],e=this,c,d,g;if(this.viewOptions.list_columnSizing&&(g=c=0,a.find("th").each(function(){var a=f(this),d=0===a.next("th").length,k;void 0!==e.list_columns[c].width?(k=e.list_columns[c].width,a.outerWidth(k),g+=a.outerWidth(),d?a.outerWidth(""):e.list_columns[c]._auto_width=k):b.push({col:a,index:c,last:d});c++}),a=b.length,0<a))for(d=Math.floor((this.$canvas.width()-g)/a),c=0;c<a;c++)b[c].last||
(b[c].col.outerWidth(d),this.list_columns[b[c].index]._auto_width=d)}f.fn.repeater&&(f.fn.repeater.Constructor.prototype.list_clearSelectedItems=function(){this.$canvas.find(".repeater-list-check").remove();this.$canvas.find(".repeater-list table tbody tr.selected").removeClass("selected")},f.fn.repeater.Constructor.prototype.list_highlightColumn=function(a,b){var e=this.$canvas.find(".repeater-list tbody");if(this.viewOptions.list_highlightSortedColumn||b)e.find("td.sorted").removeClass("sorted"),
e.find("tr").each(function(){f(this).find("td:nth-child("+(a+1)+")").addClass("sorted")})},f.fn.repeater.Constructor.prototype.list_getSelectedItems=function(){var a=[];this.$canvas.find(".repeater-list table tbody tr.selected").each(function(){var b=f(this);a.push({data:b.data("item_data"),element:b})});return a},f.fn.repeater.Constructor.prototype.list_positionHeadings=function(){var a=this.$element.find(".repeater-list-wrapper"),b=a.offset().left;0<a.scrollLeft()?a.find(".repeater-list-heading").each(function(){var a=
f(this),c=a.parents("th:first").offset().left-b+"px";a.addClass("shifted").css("left",c)}):a.find(".repeater-list-heading").each(function(){f(this).removeClass("shifted").css("left","")})},f.fn.repeater.Constructor.prototype.list_setSelectedItems=function(a,b){function e(){k=f(this);l=k.data("item_data")||{};l[a[h].property]===a[h].value&&c(k,a[h].selected)}function c(a,c){(void 0!==c?c:1)?(b||"multi"===d||g.list_clearSelectedItems(),a.hasClass("selected")||(a.addClass("selected"),a.find("td:first").prepend('<div class="repeater-list-check"><span class="glyphicon glyphicon-ok"></span></div>'))):
(a.find(".repeater-list-check").remove(),a.removeClass("selected"))}var d=this.viewOptions.list_selectable,g=this,l,h,k,n;f.isArray(a)||(a=[a]);n=!0===b||"multi"===d?a.length:d?0<a.length?1:0:0;for(h=0;h<n;h++)void 0!==a[h].index?(k=this.$canvas.find(".repeater-list table tbody tr:nth-child("+(a[h].index+1)+")"),0<k.length&&c(k,a[h].selected)):void 0!==a[h].property&&void 0!==a[h].value&&this.$canvas.find(".repeater-list table tbody tr").each(e)},f.fn.repeater.Constructor.prototype.list_sizeHeadings=
function(){this.$element.find(".repeater-list table").find("thead th").each(function(){var a=f(this),b=a.find(".repeater-list-heading");b.outerHeight(a.outerHeight());b.outerWidth(a.outerWidth())})},f.fn.repeater.defaults=f.extend({},f.fn.repeater.defaults,{list_columnRendered:null,list_columnSizing:!0,list_columnSyncing:!0,list_highlightSortedColumn:!1,list_infiniteScroll:!1,list_noItemsHTML:"",list_selectable:!1,list_sortClearing:!1,list_rowRendered:null}),f.fn.repeater.viewTypes.list={cleared:function(){this.viewOptions.list_columnSyncing&&
this.list_sizeHeadings()},dataOptions:function(a){this.list_sortDirection&&(a.sortDirection=this.list_sortDirection);this.list_sortProperty&&(a.sortProperty=this.list_sortProperty);return a},initialize:function(a,b){this.list_sortProperty=this.list_sortDirection=null;b()},resize:function(){this.viewOptions.list_columnSyncing&&this.list_sizeHeadings()},selected:function(){var a=this.viewOptions.list_infiniteScroll;this.list_firstRender=!0;this.$loader.addClass("noHeader");a&&(a="object"===typeof a?
a:{},this.infiniteScrolling(!0,a))},before:function(a){var b=a.container.find(".repeater-list"),e=this;1>b.length&&(b=f('<div class="repeater-list" data-preserve="shallow"><div class="repeater-list-wrapper" data-infinite="true" data-preserve="shallow"><table aria-readonly="true" class="table" data-preserve="shallow" role="grid"></table></div></div>'),b.find(".repeater-list-wrapper").on("scroll.fu.repeaterList",function(){e.viewOptions.list_columnSyncing&&e.list_positionHeadings()}),a.container.append(b));
b=b.find("table");u.call(this,b,a.data);t.call(this,b,a.data);return!1},renderItem:function(a){r.call(this,a.container,a.subset,a.index);return!1},after:function(){var a;this.viewOptions.list_columnSyncing&&(this.list_sizeHeadings(),this.list_positionHeadings());a=this.$canvas.find(".repeater-list-heading.sorted");0<a.length&&this.list_highlightColumn(a.data("fu_item_index"));return!1}})});