(function(f){"function"===typeof define&&define.amd?define("jquery fuelux/combobox fuelux/datepicker fuelux/radio fuelux/selectlist fuelux/spinbox".split(" "),f):f(jQuery)})(function(f){if(!(f.fn.combobox&&f.fn.datepicker&&f.fn.radio&&f.fn.selectlist&&f.fn.spinbox))throw Error("Fuel UX scheduler control requires combobox, datepicker, radio, selectlist, and spinbox.");var n=f.fn.scheduler,k=function(b,a){var e=this;this.$element=f(b);this.options=f.extend({},f.fn.scheduler.defaults,a);this.$startDate=
this.$element.find(".start-datetime .start-date");this.$startTime=this.$element.find(".start-datetime .start-time");this.$timeZone=this.$element.find(".timezone-container .timezone");this.$repeatIntervalPanel=this.$element.find(".repeat-every-panel");this.$repeatIntervalSelect=this.$element.find(".repeat-options");this.$repeatIntervalSpinbox=this.$element.find(".repeat-every");this.$repeatIntervalTxt=this.$element.find(".repeat-every-text");this.$end=this.$element.find(".repeat-end");this.$endSelect=
this.$end.find(".end-options");this.$endAfter=this.$end.find(".end-after");this.$endDate=this.$end.find(".end-on-date");this.$recurrencePanels=this.$element.find(".repeat-panel");this.$repeatIntervalSelect.selectlist();this.$element.find(".selectlist").selectlist();this.$startDate.datepicker(this.options.startDateOptions);this.$startTime.combobox();""===this.$startTime.find("input").val()&&this.$startTime.combobox("selectByIndex",0);"0"===this.$repeatIntervalSpinbox.find("input").val()?this.$repeatIntervalSpinbox.spinbox({value:1,
min:1}):this.$repeatIntervalSpinbox.spinbox({min:1});this.$endAfter.spinbox({value:1,min:1});this.$endDate.datepicker(this.options.endDateOptions);this.$element.find(".radio-custom").radio();this.$repeatIntervalSelect.on("changed.fu.selectlist",f.proxy(this.repeatIntervalSelectChanged,this));this.$endSelect.on("changed.fu.selectlist",f.proxy(this.endSelectChanged,this));this.$element.find(".repeat-days-of-the-week .btn-group .btn").on("change.fu.scheduler",function(a,b){e.changed(a,b,!0)});this.$element.find(".combobox").on("changed.fu.combobox",
f.proxy(this.changed,this));this.$element.find(".datepicker").on("changed.fu.datepicker",f.proxy(this.changed,this));this.$element.find(".selectlist").on("changed.fu.selectlist",f.proxy(this.changed,this));this.$element.find(".spinbox").on("changed.fu.spinbox",f.proxy(this.changed,this));this.$element.find(".repeat-monthly .radio, .repeat-yearly .radio").on("change.fu.scheduler",f.proxy(this.changed,this))};k.prototype={constructor:k,destroy:function(){var b;this.$element.find("input").each(function(){f(this).attr("value",
f(this).val())});this.$element.find(".datepicker .calendar").empty();b=this.$element[0].outerHTML;this.$element.find(".combobox").combobox("destroy");this.$element.find(".datepicker").datepicker("destroy");this.$element.find(".selectlist").selectlist("destroy");this.$element.find(".spinbox").spinbox("destroy");this.$element.find("[type=radio]").radio("destroy");this.$element.remove();return b},changed:function(b,a,e){e||b.stopPropagation();this.$element.trigger("changed.fu.scheduler",{data:void 0!==
a?a:f(b.currentTarget).data(),originalEvent:b,value:this.getValue()})},disable:function(){this.toggleState("disable")},enable:function(){this.toggleState("enable")},setUtcTime:function(b,a,e){b=b.split("-");a=a.split(":");a=new Date(Date.UTC(b[0],b[1]-1,b[2],a[0],a[1],a[2]?a[2]:0));"Z"===e?a.setUTCHours(a.getUTCHours()+0):(b=RegExp("(.).*?\\d.*?(\\d)",["i"]).exec(e),null!==b&&(e=b[2],b="+"===b[1]?1:-1,a.setUTCHours(a.getUTCHours()+b*parseInt(e,10))));e=a.getTimezoneOffset();a.setMinutes(e);return a},
endSelectChanged:function(b,a){var e;a?e=a.value:(e=this.$endSelect.selectlist("selectedItem"),e=e.value);this.$endAfter.parent().addClass("hide");this.$endAfter.parent().attr("aria-hidden","true");this.$endDate.parent().addClass("hide");this.$endDate.parent().attr("aria-hidden","true");"after"===e?(this.$endAfter.parent().removeClass("hide"),this.$endAfter.parent().attr("aria-hidden","false")):"date"===e&&(this.$endDate.parent().removeClass("hide"),this.$endDate.parent().attr("aria-hidden","false"))},
getValue:function(){var b=this.$repeatIntervalSpinbox.spinbox("value"),a="",e=this.$repeatIntervalSelect.selectlist("selectedItem").value,c;this.$startTime.combobox("selectedItem").value?(c=this.$startTime.combobox("selectedItem").value,c=c.toLowerCase()):c=this.$startTime.combobox("selectedItem").text.toLowerCase();var d=this.$timeZone.selectlist("selectedItem"),g;g=function(a,b){var c,d;c=""+a.getFullYear();c+=b;d=a.getMonth()+1;c=c+(10>d?"0"+d:d)+b;d=a.getDate();return c+=10>d?"0"+d:d};var h,m,
k,l;l=""+g(this.$startDate.datepicker("getDate"),"-");l+="T";m=0<=c.search("am");k=0<=c.search("pm");c=f.trim(c.replace(/am/g,"").replace(/pm/g,"")).split(":");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10);m&&11<c[0]?c[0]=0:k&&12>c[0]&&(c[0]+=12);l+=10>c[0]?"0"+c[0]:c[0];l=l+":"+(10>c[1]?"0"+c[1]:c[1]);l+="+00:00"===d.offset?"Z":d.offset;"none"===e?a="FREQ=DAILY;INTERVAL=1;COUNT=1;":"hourly"===e?a="FREQ=HOURLY;"+("INTERVAL="+b+";"):"daily"===e?a=a+"FREQ=DAILY;"+("INTERVAL="+b+";"):"weekdays"===e?
(a+="FREQ=DAILY;",a+="BYDAY=MO,TU,WE,TH,FR;",a+="INTERVAL=1;"):"weekly"===e?(h=[],this.$element.find(".repeat-days-of-the-week .btn-group input:checked").each(function(){h.push(f(this).data().value)}),a+="FREQ=WEEKLY;",a+="BYDAY="+h.join(",")+";",a+="INTERVAL="+b+";"):"monthly"===e?(a+="FREQ=MONTHLY;",a+="INTERVAL="+b+";",b=this.$element.find("input[name=repeat-monthly]:checked").val(),"bymonthday"===b?(c=parseInt(this.$element.find(".repeat-monthly-date .selectlist").selectlist("selectedItem").text,
10),a+="BYMONTHDAY="+c+";"):"bysetpos"===b&&(h=this.$element.find(".month-days").selectlist("selectedItem").value,c=this.$element.find(".month-day-pos").selectlist("selectedItem").value,a+="BYDAY="+h+";",a+="BYSETPOS="+c+";")):"yearly"===e&&(a+="FREQ=YEARLY;",b=this.$element.find("input[name=repeat-yearly]:checked").val(),"bymonthday"===b?(b=this.$element.find(".repeat-yearly-date .year-month").selectlist("selectedItem").value,c=this.$element.find(".year-month-day").selectlist("selectedItem").text,
a+="BYMONTH="+b+";",a+="BYMONTHDAY="+c+";"):"bysetpos"===b&&(h=this.$element.find(".year-month-days").selectlist("selectedItem").value,c=this.$element.find(".year-month-day-pos").selectlist("selectedItem").value,b=this.$element.find(".repeat-yearly-day .year-month").selectlist("selectedItem").value,a+="BYDAY="+h+";",a+="BYSETPOS="+c+";",a+="BYMONTH="+b+";"));b=this.$endSelect.selectlist("selectedItem").value;c="";"none"!==e&&("after"===b?c="COUNT="+this.$endAfter.spinbox("value")+";":"date"===b&&
(c="UNTIL="+g(this.$endDate.datepicker("getDate"),"")+";"));a+=c;return{startDateTime:l,timeZone:{name:d.name,offset:d.offset},recurrencePattern:a}},repeatIntervalSelectChanged:function(b,a){var e,c;a?(c=a.value,e=a.text):(e=this.$repeatIntervalSelect.selectlist("selectedItem"),c=e.value,e=e.text);this.$repeatIntervalTxt.text(e);switch(c.toLowerCase()){case "hourly":case "daily":case "weekly":case "monthly":this.$repeatIntervalPanel.removeClass("hide");this.$repeatIntervalPanel.attr("aria-hidden",
"false");break;default:this.$repeatIntervalPanel.addClass("hide"),this.$repeatIntervalPanel.attr("aria-hidden","true")}this.$recurrencePanels.addClass("hide");this.$recurrencePanels.attr("aria-hidden","true");this.$element.find(".repeat-"+c).removeClass("hide");this.$element.find(".repeat-"+c).attr("aria-hidden","false");"none"===c?(this.$end.addClass("hide"),this.$end.attr("aria-hidden","true")):(this.$end.removeClass("hide"),this.$end.attr("aria-hidden","false"))},setValue:function(b){var a,e,c,
d,g,h,k;b.startDateTime?(d=b.startDateTime.split("T"),g=d[0],d[1]?(d[1]=d[1].split(":"),a=parseInt(d[1][0],10),c=d[1][1]?parseInt(d[1][1].split("+")[0].split("-")[0].split("Z")[0],10):0,d=12>a?"AM":"PM",0===a?a=12:12<a&&(a-=12),c=10>c?"0"+c:c,h=a+":"+c,d=a+":"+c+" "+d,this.$startTime.find("input").val(d),this.$startTime.combobox("selectByText",d)):h="00:00"):(h="00:00",g=this.$startDate.datepicker("getDate"),g=g.getFullYear()+"-"+g.getMonth()+"-"+g.getDate());a="li[data";b.timeZone?(a="string"===
typeof b.timeZone?a+('-name="'+b.timeZone):b.timeZone.name?a+('-name="'+b.timeZone.name):a+('-offset="'+b.timeZone.offset),k=b.timeZone.offset,this.$timeZone.selectlist("selectBySelector",a+'"]')):b.startDateTime?(d=(d=b.startDateTime.split("T")[1])?-1<d.search(/\+/)?"+"+f.trim(d.split("+")[1]):-1<d.search(/\-/)?"-"+f.trim(d.split("-")[1]):"+00:00":"+00:00",k="+00:00"===d?"Z":d,a+='-offset="'+d+'"]',this.$timeZone.selectlist("selectBySelector",a)):k="Z";if(b.recurrencePattern){c={};d=b.recurrencePattern.toUpperCase().split(";");
b=0;for(e=d.length;b<e;b++)""!==d[b]&&(a=d[b].split("="),c[a[0]]=a[1]);if("DAILY"===c.FREQ)a="MO,TU,WE,TH,FR"===c.BYDAY?"weekdays":"1"===c.INTERVAL&&"1"===c.COUNT?"none":"daily";else if("HOURLY"===c.FREQ)a="hourly";else if("WEEKLY"===c.FREQ){if(c.BYDAY)for(a=this.$element.find(".repeat-days-of-the-week .btn-group"),a.find("label").removeClass("active"),d=c.BYDAY.split(","),b=0,e=d.length;b<e;b++)a.find('input[data-value="'+d[b]+'"]').prop("checked",!0).parent().addClass("active");a="weekly"}else"MONTHLY"===
c.FREQ?(this.$element.find(".repeat-monthly input").removeAttr("checked").removeClass("checked"),this.$element.find(".repeat-monthly label.radio-custom").removeClass("checked"),c.BYMONTHDAY?(d=this.$element.find(".repeat-monthly-date"),d.find("input").addClass("checked").prop("checked",!0),d.find("label.radio-custom").addClass("checked"),d.find(".selectlist").selectlist("selectByValue",c.BYMONTHDAY)):c.BYDAY&&(d=this.$element.find(".repeat-monthly-day"),d.find("input").addClass("checked").prop("checked",
!0),d.find("label.radio-custom").addClass("checked"),c.BYSETPOS&&d.find(".month-day-pos").selectlist("selectByValue",c.BYSETPOS),d.find(".month-days").selectlist("selectByValue",c.BYDAY)),a="monthly"):"YEARLY"===c.FREQ?(this.$element.find(".repeat-yearly input").removeAttr("checked").removeClass("checked"),this.$element.find(".repeat-yearly label.radio-custom").removeClass("checked"),c.BYMONTHDAY?(d=this.$element.find(".repeat-yearly-date"),d.find("input").addClass("checked").prop("checked",!0),d.find("label.radio-custom").addClass("checked"),
c.BYMONTH&&d.find(".year-month").selectlist("selectByValue",c.BYMONTH),d.find(".year-month-day").selectlist("selectByValue",c.BYMONTHDAY)):c.BYSETPOS&&(d=this.$element.find(".repeat-yearly-day"),d.find("input").addClass("checked").prop("checked",!0),d.find("label.radio-custom").addClass("checked"),d.find(".year-month-day-pos").selectlist("selectByValue",c.BYSETPOS),c.BYDAY&&d.find(".year-month-days").selectlist("selectByValue",c.BYDAY),c.BYMONTH&&d.find(".year-month").selectlist("selectByValue",c.BYMONTH)),
a="yearly"):a="none";c.COUNT?(this.$endAfter.spinbox("value",parseInt(c.COUNT,10)),this.$endSelect.selectlist("selectByValue","after")):c.UNTIL&&(d=c.UNTIL,8===d.length&&(d=d.split(""),d.splice(4,0,"-"),d.splice(7,0,"-"),d=d.join("")),g=this.$timeZone.selectlist("selectedItem"),b="+00:00"===g.offset?"Z":g.offset,g=d,d=this.setUtcTime(g,h,b),this.$endDate.datepicker("setDate",d),this.$endSelect.selectlist("selectByValue","date"));this.endSelectChanged();c.INTERVAL&&this.$repeatIntervalSpinbox.spinbox("value",
parseInt(c.INTERVAL,10));this.$repeatIntervalSelect.selectlist("selectByValue",a);this.repeatIntervalSelectChanged()}h=this.setUtcTime(g,h,k);this.$startDate.datepicker("setDate",h)},toggleState:function(b){this.$element.find(".combobox").combobox(b);this.$element.find(".datepicker").datepicker(b);this.$element.find(".selectlist").selectlist(b);this.$element.find(".spinbox").spinbox(b);this.$element.find("[type=radio]").radio(b);b="disable"===b?"addClass":"removeClass";this.$element.find(".repeat-days-of-the-week .btn-group")[b]("disabled")},
value:function(b){return b?this.setValue(b):this.getValue()}};f.fn.scheduler=function(b){var a=Array.prototype.slice.call(arguments,1),e,c=this.each(function(){var c=f(this),g=c.data("fu.scheduler"),h="object"===typeof b&&b;g||c.data("fu.scheduler",g=new k(this,h));"string"===typeof b&&(e=g[b].apply(g,a))});return void 0===e?c:e};f.fn.scheduler.defaults={};f.fn.scheduler.Constructor=k;f.fn.scheduler.noConflict=function(){f.fn.scheduler=n;return this};f(document).on("mousedown.fu.scheduler.data-api",
"[data-initialize=scheduler]",function(b){b=f(b.target).closest(".scheduler");b.data("fu.scheduler")||b.scheduler(b.data())});f(function(){f("[data-initialize=scheduler]").each(function(){var b=f(this);b.data("scheduler")||b.scheduler(b.data())})})});