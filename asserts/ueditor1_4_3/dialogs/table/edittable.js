(function(){var g=$G("J_title"),h=$G("J_titleCol"),k=$G("J_caption"),e=$G("J_sorttable"),n=$G("J_autoSizeContent"),m=$G("J_autoSizePage"),l=$G("J_tone"),d,r=$G("J_preview"),p=function(){d=this;d.init()};p.prototype={init:function(){var a=new UE.ui.ColorPicker({editor:editor}),b=new UE.ui.Popup({editor:editor,content:a});g.checked=-1==editor.queryCommandState("inserttitle");h.checked=-1==editor.queryCommandState("inserttitlecol");k.checked=-1==editor.queryCommandState("insertcaption");e.checked=1==
editor.queryCommandState("enablesort");var f=editor.queryCommandState("enablesort"),c=editor.queryCommandState("disablesort");e.checked=!!(0>f&&0<=c);e.disabled=!!(0>f&&0>c);e.title=0>f&&0>c?lang.errorMsg:"";d.createTable(g.checked,h.checked,k.checked);d.setAutoSize();d.setColor(d.getColor());domUtils.on(g,"click",d.titleHanler);domUtils.on(h,"click",d.titleColHanler);domUtils.on(k,"click",d.captionHanler);domUtils.on(e,"click",d.sorttableHanler);domUtils.on(n,"click",d.autoSizeContentHanler);domUtils.on(m,
"click",d.autoSizePageHanler);domUtils.on(l,"click",function(){b.showAnchor(l)});domUtils.on(document,"mousedown",function(){b.hide()});a.addListener("pickcolor",function(a,c){d.setColor(c);b.hide()});a.addListener("picknocolor",function(){d.setColor("");b.hide()})},createTable:function(a,b,f){var c=[];c.push("<table id='J_example'>");f&&c.push("<caption>"+lang.captionName+"</caption>");if(a){c.push("<tr>");b&&c.push("<th>"+lang.titleName+"</th>");for(a=0;5>a;a++)c.push("<th>"+lang.titleName+"</th>");
c.push("</tr>")}for(a=0;6>a;a++){c.push("<tr>");b&&c.push("<th>"+lang.titleName+"</th>");for(f=0;5>f;f++)c.push("<td>"+lang.cellsName+"</td>");c.push("</tr>")}c.push("</table>");r.innerHTML=c.join("");this.updateSortSpan()},titleHanler:function(){var a=$G("J_example"),b=document.createDocumentFragment(),f=domUtils.getComputedStyle(domUtils.getElementsByTagName(a,"td")[0],"border-color"),c=a.rows[0].children.length;if(g.checked){a.insertRow(0);for(var q=0,e;q<c;q++)e=document.createElement("th"),e.innerHTML=
lang.titleName,b.appendChild(e);a.rows[0].appendChild(b)}else domUtils.remove(a.rows[0]);d.setColor(f);d.updateSortSpan()},titleColHanler:function(){var a=$G("J_example"),b=domUtils.getComputedStyle(domUtils.getElementsByTagName(a,"td")[0],"border-color"),a=a.rows,f=a.length;if(h.checked)for(var c=0,e;c<f;c++)e=document.createElement("th"),e.innerHTML=lang.titleName,a[c].insertBefore(e,a[c].children[0]);else for(c=0;c<f;c++)domUtils.remove(a[c].children[0]);d.setColor(b);d.updateSortSpan()},captionHanler:function(){var a=
$G("J_example");if(k.checked){var b=document.createElement("caption");b.innerHTML=lang.captionName;a.insertBefore(b,a.firstChild)}else domUtils.remove(domUtils.getElementsByTagName(a,"caption")[0])},sorttableHanler:function(){d.updateSortSpan()},autoSizeContentHanler:function(){$G("J_example").removeAttribute("width")},autoSizePageHanler:function(){var a=$G("J_example"),b=a.getElementsByTagName(a,"td");utils.each(b,function(a){a.removeAttribute("width")});a.setAttribute("width","100%")},updateSortSpan:function(){var a=
$G("J_example"),b=a.rows[0],a=domUtils.getElementsByTagName(a,"span");utils.each(a,function(a){a.parentNode.removeChild(a)});e.checked&&utils.each(b.cells,function(a,c){var b=document.createElement("span");b.innerHTML="^";a.appendChild(b)})},getColor:function(){var a=editor.selection.getStart();(a=(a=domUtils.findParentByTagName(a,["td","th","caption"],!0))&&domUtils.getComputedStyle(a,"border-color"))||(a="#DDDDDD");return a},setColor:function(a){var b=$G("J_example"),b=domUtils.getElementsByTagName(b,
"td").concat(domUtils.getElementsByTagName(b,"th"),domUtils.getElementsByTagName(b,"caption"));l.value=a;utils.each(b,function(b){b.style.borderColor=a})},setAutoSize:function(){m.checked=!0;this.autoSizePageHanler()}};new p;dialog.onok=function(){editor.__hasEnterExecCommand=!0;var a={title:"inserttitle deletetitle",titleCol:"inserttitlecol deletetitlecol",caption:"insertcaption deletecaption",sorttable:"enablesort disablesort"};editor.fireEvent("saveScene");for(var b in a){var d=a[b].split(" ");
$G("J_"+b).checked?-1!=editor.queryCommandState(d[0])&&editor.execCommand(d[0]):-1!=editor.queryCommandState(d[1])&&editor.execCommand(d[1])}editor.execCommand("edittable",l.value);n.checked?editor.execCommand("adaptbytext"):"";m.checked?editor.execCommand("adaptbywindow"):"";editor.fireEvent("saveScene");editor.__hasEnterExecCommand=!1}})();