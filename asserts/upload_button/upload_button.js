var _T_UPLOAD_BUTTON_WAITING={},_T_UPLOAD_BUTTON_CALLBACK={};
(function(b){b.fn.UploadButton=function(c){c=b.extend({value_holder:"",preview_holder:"",width:200,height:100,postURL:"/app/libs/upload_button/demo_upload.php",background:"http://images.cnblogs.com/cnblogs_com/dreamback/437546/o_ff6.png",acceptExt:".pdf,.txt",showLoading:!1,showAlert:!0,callback:null},c);return this.each(function(){var d=b(this),a=c,e=d.attr("id"),f=e,f=f.replace(/-/g,"_");_T_UPLOAD_BUTTON_CALLBACK[f]=c.callback;if(e){var e="iframe-upload-button-"+e,h=['<iframe id="',e,'" scrolling="no" frameborder="0" style="width:',
a.width,"px;height:",a.height,'px;"></iframe>'];b(d).html(h.join(""));setTimeout(function(){var h=['<form enctype="multipart/form-data" action="',a.postURL,'" method="post" target="hideiframe">','<div style="width:',a.width,"px;height:",a.height,"px;background:url(",a.background,') no-repeat;position:relative;cursor:pointer;">','<input type="hidden" name="value_holder" value="',a.value_holder,'" />','<input type="hidden" name="preview_holder" value="',a.preview_holder,'" />','<input type="hidden" name="upload_id" value="',
f,'" />','<input type="hidden" name="show_alert" value="',c.showAlert?"1":"0",'" />','<input type="file"   name="value_file" accept="',a.acceptExt,'" style="width:',a.width,"px;height:",a.height,"px;overflow:hidden;font-size: ",a.height,'px;position:absolute;right:0;top:0;cursor:pointer;opacity:0;filter:alpha(opacity=0);" />',"</div>","</form>",'<iframe name="hideiframe" scrolling="no" frameborder="0" style="width:1px;height:10px;"></iframe>'];if((d=b("#"+e).get(0))&&d.contentWindow){b(d.contentWindow.document.head).html("<meta charset='utf-8'/>");
var g=b(d.contentWindow.document.body);g.css({padding:0,margin:0});g.html(h.join(""));var k=function(){c.showLoading&&b.dialog&&(_T_UPLOAD_BUTTON_WAITING[f]=b.dialog.tips(lhgdialog_lang.UPLOADING,60,"loading.gif"));b(this).closest("form").submit();b(this).replaceWith(['<input type="file"   name="value_file" accept="',a.acceptExt,'" style="width:',a.width,"px;height:",a.height,"px;overflow:hidden;font-size: ",a.height,'px;position:absolute;right:0;top:0;cursor:pointer;opacity:0;filter:alpha(opacity=0);" />'].join(""));
b("input[name='value_file']",g).on("change",k)};b("input[name='value_file']",g).on("change",k)}},0)}})}})(jQuery);